services:
  # Ambilight extractor: Python daemon + Rust extractor binary
  ambilight-extractor:
    build:
      context: .
      dockerfile: Dockerfile.extractor
    container_name: ambilight-extractor
    restart: unless-stopped
    env_file:
      - .env
    volumes:
      - ${PWD:-.}:/app
      - ${DATA_PATH:-./data}:/app/data
      - ${MOVIES_PATH:-./test-media/movies}:/media/movies:ro
      - ${TV_PATH:-./test-media/tv}:/media/tv:ro

    networks:
      homelab-network:
        ipv4_address: 10.1.0.20
    dns:
      - 192.168.1.191
      - 1.1.1.1

  ambilight-player:
    build:
      context: .
      dockerfile: Dockerfile.player
    container_name: ambilight-player
    restart: unless-stopped
    env_file:
      - .env
    volumes:
      - ${PWD:-.}:/app
      - ${DATA_PATH:-./data}:/app/data
      - ${MOVIES_PATH:-./test-media/movies}:/media/movies:ro
      - ${TV_PATH:-./test-media/tv}:/media/tv:ro

    networks:
      homelab-network:
        ipv4_address: 10.1.0.21
    dns:
      - 192.168.1.191
      - 1.1.1.1
volumes:
  ambilight-data:

networks:
  homelab-network:
    external: true
